#!groovy

properties([
        parameters([string(name: 'LIB_VERSION', defaultValue: 'master', description: 'Branch name of pipeline library to use')]),
        pipelineTriggers([cron('15 01 * * *')])
])

library "Infrastructure@${params.LIB_VERSION}"

String product = "div"

String component = "pfe"

def type = "nodejs"


withNightlyPipeline(type,product,component) {
    environment {
        env.SAUCE_ACCESS_KEY = credentials('SAUCE_ACCESS_KEY')
        env.SAUCE_USERNAME = credentials('SAUCE_USERNAME')

    }

    //echo "sauce labs access key ${env.SAUCE_ACCESS_KEY}"


    env.TEST_URL = 'https://www.apply-divorce.service.gov.uk'
        sauce('${env.SAUCE_ACCESS_KEY}') { // <2>
        sauceconnect(options: '', useGeneratedTunnelIdentifier: false, verboseLogging: false) { // <3>
        enableCrossBrowserTest()
       }
    }
    enablePerformanceTest()
}

